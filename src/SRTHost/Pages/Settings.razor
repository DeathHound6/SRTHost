@page "/Settings"

<PageTitle>Settings</PageTitle>

<Container>
    <MudPaper Class="w-full h-full flex-col gap-4 rounded-none">
        <PageHeader>
            <MudText Typo="Typo.h5">Settings</MudText>
            <MudSpacer />
            <MudButton Variant="Variant.Filled" Color="Color.Secondary" OnClick="SaveSettings">
                Save Settings
            </MudButton>
        </PageHeader>
        <MudCheckBox @bind-Checked="@HostConfiguration.ShowDebugMenu" Color="Color.Secondary">Show Debug Menu</MudCheckBox>
    </MudPaper>
</Container>

@code
{
    public HostConfiguration HostConfiguration { get; set; } = new HostConfiguration();

    protected override Task OnInitializedAsync()
    {
        if (pluginHost.ConfigurationDB is not null)
            HostConfiguration = pluginHost.ConfigurationDB.DbLoadConfiguration().ConfigDictionaryToModel<HostConfiguration>();
        return base.OnInitializedAsync();
    }

    public void SaveSettings()
    {
        if (pluginHost.ConfigurationDB is not null)
            pluginHost.ConfigurationDB.DbSaveConfiguration(HostConfiguration.ModelToConfigDictionary());
    }
}